package com.hack.simulacao.seed;

import org.springframework.stereotype.Component;

import com.hack.simulacao.domain.sqlserver.Produto;
import com.hack.simulacao.infra.repository.sqlserver.ProdutoRepository;

import org.springframework.context.annotation.Profile;

import java.math.BigDecimal;
import java.math.RoundingMode;
import java.util.List;

import org.springframework.boot.CommandLineRunner;


@Component
@Profile("dev")
public class ProdutoSeeder implements CommandLineRunner {

    private final ProdutoRepository produtoRepository;

    public ProdutoSeeder(ProdutoRepository produtoRepository) {
        this.produtoRepository = produtoRepository;
    }

    @Override
    public void run(String... args) {

        if (produtoRepository.count() == 0) {
                Produto p1 = new Produto();
                p1.setCoProduto(1);
                p1.setNoProduto("Produto 1");
                p1.setPcTaxaJuros(new BigDecimal("0.017900000").setScale(8, RoundingMode.HALF_UP));
                p1.setNuMinimoMeses(0);
                p1.setNuMaximoMeses(24);
                p1.setVrMinimo(new BigDecimal("200.00"));
                p1.setVrMaximo(new BigDecimal("10000.00"));

                Produto p2 = new Produto();
                p2.setCoProduto(2);
                p2.setNoProduto("Produto 2");
                p2.setPcTaxaJuros(new BigDecimal("0.017500000").setScale(8, RoundingMode.HALF_UP));
                p2.setNuMinimoMeses(25);
                p2.setNuMaximoMeses(48);
                p2.setVrMinimo(new BigDecimal("10001.00"));
                p2.setVrMaximo(new BigDecimal("100000.00"));

                Produto p3 = new Produto();
                p3.setCoProduto(3);
                p3.setNoProduto("Produto 3");
                p3.setPcTaxaJuros(new BigDecimal("0.018200000").setScale(8, RoundingMode.HALF_UP));
                p3.setNuMinimoMeses(49);
                p3.setNuMaximoMeses(96);
                p3.setVrMinimo(new BigDecimal("100000.01"));
                p3.setVrMaximo(new BigDecimal("1000000.00"));

                Produto p4 = new Produto();
                p4.setCoProduto(4);
                p4.setNoProduto("Produto 4");
                p4.setPcTaxaJuros(new BigDecimal("0.015100000").setScale(8, RoundingMode.HALF_UP));
                p4.setNuMinimoMeses(96);
                p4.setVrMinimo(new BigDecimal("1000000.01"));

                produtoRepository.saveAll(List.of(p1, p2, p3, p4));

                System.out.println("Seeder executado; Produtos inseridos");
        }

    }
}
